# 董公擇日 App 實施計劃

## 專案哲學

### 核心信念
- **增量進步勝過大爆炸** - 小步快跑，每次變更都能編譯和通過測試
- **從現有代碼學習** - 研究和規劃先於實施
- **實用主義勝過教條主義** - 適應專案現實
- **清晰意圖勝過聰明代碼** - 選擇無聊但明顯的解決方案

### 簡潔性原則
- 每個函數/類單一職責
- 避免過早抽象
- 不使用聰明技巧 - 選擇無聊的解決方案
- 如果需要解釋，就太複雜了

---

## Stage 1: 董公擇日核心計算引擎 ✅ **Complete**

**Goal**: 建立準確可靠的董公擇日專業計算系統
**Success Criteria**: 
- 與權威網站準確度達100%
- 所有核心算法測試通過
- 系統信心指數≥95分

**Tests**: 
- ✅ 十二建星計算準確性測試
- ✅ 神煞系統計算驗證
- ✅ 八字配合分析測試
- ✅ 特殊日期識別測試
- ✅ 準確性驗證機制測試

**Status**: **Complete** (2025/8/6)

**完成項目**:
- ✅ 農曆計算服務整合 (lunar-javascript)
- ✅ 十二建星專業計算系統
- ✅ 神煞系統完整計算引擎
- ✅ 個人八字配合專業系統
- ✅ 特殊日期識別系統
- ✅ 計算驗證和準確性保證機制

**品質指標**:
- 總體準確度: 100%
- 系統信心指數: 96分 (excellent)
- 測試覆蓋率: 100% (26/26 tests passed)

---

## Stage 2: 董公日曆專業檢視功能

**Goal**: 開發以十二建星為核心的專業日曆檢視系統
**Success Criteria**: 
- 月曆正確顯示十二建星
- 黃道吉日/黑道凶日視覺化標示準確
- 特殊日期醒目標記功能完整
- 神煞配置快速預覽可用

**Tests**: 
- [ ] 月曆組件渲染測試
- [ ] 建星標示準確性測試
- [ ] 特殊日期標記測試
- [ ] 神煞預覽功能測試
- [ ] 日期篩選系統測試

**Status**: **Not Started**

**實施子任務**:
- [ ] 2.1 建立月曆基礎組件架構
- [ ] 2.2 實作十二建星視覺化標示
- [ ] 2.3 加入黃道吉日/黑道凶日色彩系統
- [ ] 2.4 實作特殊日期醒目標記
- [ ] 2.5 建立神煞配置快速預覽

---

## Stage 3: 董公分析詳情頁面

**Goal**: 建立完整的董公七步操作法分析展示系統
**Success Criteria**: 
- 七步操作法完整展示
- 十二建星詳細說明準確
- 神煞配置專業分析清晰
- 個人八字配合結果易懂

**Tests**: 
- [ ] 七步操作法展示測試
- [ ] 建星詳細說明測試
- [ ] 神煞分析界面測試
- [ ] 八字配合顯示測試
- [ ] 時辰分析展示測試

**Status**: **Not Started**

**實施子任務**:
- [ ] 3.1 設計七步操作法展示組件
- [ ] 3.2 建立建星詳細說明界面
- [ ] 3.3 實作神煞配置專業分析
- [ ] 3.4 開發八字配合結果顯示
- [ ] 3.5 加入時辰分析精確展示

---

## Stage 4: 個人化擇日推薦系統

**Goal**: 實作基於個人八字的智能擇日推薦功能
**Success Criteria**: 
- 事項分類選擇界面完整
- 個人八字推薦算法準確
- 不同事項專門規則正確應用
- 推薦理由說明清晰

**Tests**: 
- [ ] 事項分類界面測試
- [ ] 個人化推薦算法測試
- [ ] 專門規則應用測試
- [ ] 推薦理由生成測試
- [ ] 時辰推薦功能測試

**Status**: **Not Started**

**實施子任務**:
- [ ] 4.1 建立事項分類選擇系統
- [ ] 4.2 開發個人化推薦算法
- [ ] 4.3 實作事項專門規則引擎
- [ ] 4.4 建立推薦理由說明系統
- [ ] 4.5 加入時辰推薦精確功能

---

## Stage 5: 分級服務與商業化整合

**Goal**: 實作董公擇日三級服務體系和商業化功能
**Success Criteria**: 
- 三級服務架構完整
- 權限控制系統正確
- 內購系統整合成功
- 用戶管理功能完善

**Tests**: 
- [ ] 服務分級功能測試
- [ ] 權限控制系統測試
- [ ] 內購流程測試
- [ ] 用戶管理系統測試
- [ ] 訂閱狀態管理測試

**Status**: **Not Started**

**實施子任務**:
- [ ] 5.1 建立三級服務架構
- [ ] 5.2 實作功能權限控制
- [ ] 5.3 整合內購系統
- [ ] 5.4 開發用戶管理功能
- [ ] 5.5 建立訂閱狀態管理

---

## 技術標準

### 架構原則
- **組合勝過繼承** - 使用依賴注入
- **接口勝過單例** - 啟用測試和靈活性
- **顯式勝過隱式** - 清晰的數據流和依賴關係
- **盡可能測試驅動** - 永不禁用測試，修復它們

### 代碼品質
每次提交必須：
- ✅ 編譯成功
- ✅ 通過所有現有測試
- ✅ 包含新功能的測試
- ✅ 遵循專案格式化/linting

### 錯誤處理
- 快速失敗並提供描述性消息
- 包含調試上下文
- 在適當級別處理錯誤
- 永不靜默吞噬異常

### 決策框架
當存在多個有效方法時，基於以下選擇：
1. **可測試性** - 我能輕鬆測試這個嗎？
2. **可讀性** - 6個月後有人能理解這個嗎？
3. **一致性** - 這符合專案模式嗎？
4. **簡潔性** - 這是有效的最簡單解決方案嗎？
5. **可逆性** - 以後改變有多困難？

---

## 品質門檻

### 完成定義
- ✅ 測試編寫並通過
- ✅ 代碼遵循專案約定
- ✅ 無linter/formatter警告
- ✅ 提交消息清晰
- ✅ 實施符合計劃
- ✅ 無未解決的TODO

### 測試指導原則
- 測試行為，不是實現
- 盡可能每個測試一個斷言
- 清晰的測試名稱描述場景
- 使用現有測試工具/助手
- 測試應該是確定性的

---

## 重要提醒

### 永不：
- ❌ 使用 --no-verify 繞過提交鉤子
- ❌ 禁用測試而不是修復它們
- ❌ 提交不能編譯的代碼
- ❌ 做假設 - 用現有代碼驗證

### 總是：
- ✅ 增量提交工作代碼
- ✅ 隨時更新計劃文檔
- ✅ 從現有實現學習
- ✅ 3次失敗嘗試後停止並重新評估

---

## 當遇到困難時（3次嘗試後）

**關鍵：每個問題最多3次嘗試，然後停止。**

### 記錄失敗：
- 你嘗試了什麼
- 具體錯誤消息
- 你認為失敗的原因

### 研究替代方案：
- 找到2-3個類似實現
- 注意使用的不同方法

### 質疑基本假設：
- 這是正確的抽象級別嗎？
- 這能分解成更小的問題嗎？
- 有完全更簡單的方法嗎？

### 嘗試不同角度：
- 不同的庫/框架特性？
- 不同的架構模式？
- 移除抽象而不是添加？

---

*此計劃將在所有階段完成後移除。*